# SPDX-FileCopyrightText: 2025 Helmholtz-Zentrum hereon GmbH
# SPDX-License-Identifier: CC0-1.0
# SPDX-FileContributor: Carsten Lemmen <carsten.lemmen@hereon.de>

include:
  - ".gitlab/lint-license.yaml"
  - ".gitlab/deploy-joss.yaml"
  - ".gitlab/deploy-docker.yaml"
  - ".gitlab/deploy-zenodo.yaml" # enable once we have .zenodo.json
  - template: Security/SAST.gitlab-ci.yml
  - template: Security/Secret-Detection.gitlab-ci.yml
stages:
  - lint
  - test
  - run
  - deploy

# Automated job for software security, provided by GitLab
sast:
  stage: test

release_job:
  stage: deploy
  image: registry.gitlab.com/gitlab-org/release-cli:latest
  rules:
    - if: $CI_COMMIT_TAG # Run this job when a tag is created
  script:
    - echo "Running release_job"
  release: # See https://docs.gitlab.com/ee/ci/yaml/#release for available properties
    tag_name: "$CI_COMMIT_TAG"
    description: "$CI_COMMIT_TAG"

pages:
  stage: deploy
  script:
    - make dev-install
    - sphinx-build -b html doc public
  artifacts:
    paths:
      - public
  only:
    - main
